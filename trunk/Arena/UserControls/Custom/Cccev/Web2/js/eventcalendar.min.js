var central_eventCalendar=(function(){var a=[];var u=new Date();var s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var i="";function t(){b();switch(i.toLowerCase()){case"calendar":$("#event-calendar").fullCalendar("destroy");$("#event-calendar").fadeIn("fast");r(central_calendarControls.getParams());break;case"cloud":p(central_calendarControls.getParams());$("#event-cloud").fadeIn("fast");break;case"list":o(central_calendarControls.getParams());$("#event-list-wrapper").fadeIn("fast");break}}function b(){$("html, body").animate({scrollTop:0},1000,"easeOutCubic");j(i).css({height:$(".event-view:visible").outerHeight()+30+"px"}).fadeIn("fast");$(".event-view").fadeOut("fast")}function j(z){switch(z){case"cloud":return $("#cloud-overlay");case"list":return $("#event-list-overlay");case"calendar":default:return $("#calendar-overlay")}}function g(A,C,B){var z=A.children(B);if(z.is(":hidden")){var D=A.offset();z.css({left:C.pageX-D.left+20+"px",top:C.pageY-D.top+"px"}).fadeIn("fast")}}function h(A,B){var z=A.children(B);if(z.is(":visible")){A.children(B).fadeOut("fast")}}function d(A,C,B){var z=A.children(B);if(z.is(":visible")){var D=A.offset();z.css({left:C.pageX-D.left+20+"px",top:C.pageY-D.top+"px"})}}function e(F){var D=F.toTimeString();var E=D.split(":");var A=E[0];var C=E[1];var B=true;if(parseInt(A)>12){B=false;A=A-12}if(A.length>1&&A[0]==0){A=A[1]}var z=A+":"+C;z+=B?" AM":" PM";return z}function c(A){var z=A.length>0?A:[-1];return z.join(",")}function r(z){$("#event-calendar").fullCalendar({viewDisplay:q,events:function(E,B,D){var A=$("#ihCalendarEventDetails").val();var C='{ "start":"'+E.toDateString()+'", "end":"'+B.toDateString()+'", "keywords":"'+z.keywords+'", "topicIDs":"'+z.topicIDs+'", "campusIDs":"'+c(z.campuses)+'", "pageID": '+A+" }";$.ajax({type:"POST",url:"webservices/custom/cccev/web2/eventsservice.asmx/GetEventList",contentType:"application/json; charset=utf-8",data:C,dataType:"json"}).success(function(F){a=F.d;D(a);q();return false}).error(w)},loading:function(B,A){if(B){$("#calendar-overlay").css({height:$("#event-calendar").outerHeight()+20+"px"}).fadeIn("fast")}else{$(".spinner").fadeOut("fast")}return false}});if(u.getMonth()!=new Date().getMonth()){$("#event-calendar").fullCalendar("gotoDate",u)}}function f(C,A){var z=$("#event-calendar").fullCalendar("getView");var B=z.start;if(B.getFullYear<1900){B=new Date(B.getFullYear()+1900,B.getMonth(),B.getDate())}u=B;$("#event-calendar").fullCalendar("destroy");r(A);return false}function q(z){$(document).trigger("CONTENT_RENDERED");$(".fc-event").hoverIntent(function(A){g($(this),A,".fc-event-description");return false},function(){h($(this),".fc-event-description");return false}).mousemove(function(A){d($(this),A,".fc-event-description");return false})}function l(A){var F=[];for(var D=0;D<A.length;D++){var z=false;var E=A[D];for(var C=0;C<F.length;C++){if(E.id==F[C].id){z=true;break}}if(!z){var B=new Date(E.start);E.time=m(B)+" "+y(B)+", "+e(B);F.push(E)}}return F}function w(A,z,B){return false}function p(B){var z=$("#ihCloudEventDetails").val();var A='{ "start":"'+B.start.toDateString()+'", "end":"'+B.end.toDateString()+'", "keywords":"'+B.keywords+'", "topicIDs":"'+B.topicIDs+'", "campusIDs":"'+c(B.campuses)+'", "pageID": '+z+" }";$.ajax({type:"POST",url:"webservices/custom/cccev/web2/eventsservice.asmx/GetAlphabeticalEventList",contentType:"application/json; charset=utf-8",data:A,dataType:"json"}).success(function(C){a=C.d;var E=l(a);$("#event-cloud ul").children().remove();$("#cloud-item").render(E).appendTo("#event-cloud ul");var D=B.campusNames.length>0?B.campusNames.join(", "):"All Campuses";$("#event-cloud .campus").html(D);x();$(".spinner").fadeOut("fast");return false}).error(w())}function v(A,z){$("#cloud-overlay").fadeIn("fast");p(z);return false}function x(){$(".tag").hoverIntent(function(z){g($(this),z,".tag-description");return false},function(){h($(this),".tag-description");return false}).mousemove(function(z){d($(this),z,".tag-description");return false})}function o(B){$("#event-list-overlay").height($("#event-list-overlay").parent().height()+200);$("#event-list-overlay").fadeIn("fast");var z=$("#ihListEventDetails").val();var A='{ "start":"'+B.start.toDateString()+'", "end":"'+B.end.toDateString()+'", "keywords":"'+B.keywords+'", "topicIDs":"'+B.topicIDs+'", "campusIDs":"'+c(B.campuses)+'", "pageID": '+z+" }";$.ajax({type:"POST",url:"webservices/custom/cccev/web2/eventsservice.asmx/GetEventList",contentType:"application/json; charset=utf-8",data:A,dataType:"json"}).success(function(C){a=C.d;k(a);$(".spinner").fadeOut("fast");return false}).error(w)}function n(A,z){o(z);return false}function k(B){$("#event-featured-list").children().remove();$("#event-list").children().remove();if(typeof a==="undefined"||a.length===0){return false}for(var A=0;A<B.length;A++){a[A].date=y(new Date(B[A].start));a[A].month=m(new Date(B[A].start))}var C=l(a);var z=0;if(C.length<z){z=C.length}z=(z==3)?2:z;C=C.slice(0,z);$("#event-featured-list-template").render(C).appendTo("#event-featured-list");$("#event-list-template").render(B).appendTo("#event-list");return false}function y(A){var z=A.getDate();if(z<10){z="0"+z}return z}function m(z){return s[z.getMonth()]}return{init:function(){$("#event-calendar").fadeIn("fast");central_calendarControls.setTopics($("#ihTopicAreas").val().trim()!=""?$("#ihTopicAreas").val():"");r(central_calendarControls.getParams());$(document).bind("CALENDAR_INFO_CHANGED",function(A,z){switch(i.toLowerCase()){case"cloud":v(A,z);break;case"list":n(A,z);break;case"calendar":default:f(A,z);break}return false});$(document).bind("CALENDAR_VIEW_CHANGED",function(z,A){i=A;t();return false})},getEventTime:function(z){return e(z)}}})();$(function(){central_eventCalendar.init()});
