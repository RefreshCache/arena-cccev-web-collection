(function(){window.central_calendarControls=(function(){var j="",l={start:new Date(),end:new Date(),keywords:"",topicIDs:"",campuses:[],campusNames:[]};function b(o){var m=new Date();var n=new Date(Date.parse(o));if((m.getMonth()==n.getMonth())&&(m.getDate()==n.getDate())){return"Today"}return o.substring(o.indexOf(" ")+1,o.length-4)}function c(n,o){var m=new Date();m.setDate(m.getDate()+o.values[0]);l.start=m;var p=new Date();p.setDate(p.getDate()+o.values[1]);l.end=p;$(".min").text(b(m.toDateString()));$(".max").text(b(p.toDateString()))}function k(){$(document).trigger("CALENDAR_INFO_CHANGED",l)}function d(){l.campuses=[];l.campusNames=[];$("#campuses > li").removeClass();$("#campuses input:checkbox:checked").each(function(){var m=$(this),o=m.attr("data-id"),n=m.next("label").text();m.parent("li").removeClass().addClass("selected");if($.inArray(o,l.campuses)===-1){l.campuses.push(o)}if($.inArray(n,l.campusNames)===-1){l.campusNames.push(n)}})}function i(){var n=new Date();l.start=n;$(".min").text(b(n.toDateString()));var m=new Date();m.setDate(m.getDate()+90);l.end=m;$(".max").text(b(m.toDateString()));d()}function e(){$("#campuses input:checkbox").click(function(){d();k()})}function h(){$("#date-slider").slider({range:true,min:0,max:365,step:7,values:[0,90],slide:c});$(document).bind("slidechange",function(m,n){k();return false})}function a(){$(".calendar-search").change(function(){l.keywords=$(".calendar-search").val();k();$(document).unbind("submit").submit(function(){return false});return false});$(".calendar-search").keypress(function(m){if(m.which===13){$(".calendar-search").change();return false}return true})}function f(){$("input[name='calendar-view']").click(function(){j=$(this).attr("rel");$(document).trigger("CALENDAR_VIEW_CHANGED",[j]);return true})}function g(){$(document).bind("CAMPUS_UPDATED",function(){$(document).trigger("CALENDAR_INFO_CHANGED",l);return false});$(document).bind("CALENDAR_VIEW_CHANGED",function(){if(j.toLowerCase()=="calendar"){$("#slider-wrap").slideUp()}else{$("#slider-wrap").slideDown()}return false})}return{init:function(){i();$("input[name='calendar-view']:first").attr("checked","checked");$(".calendar-search").val("");e();h();a();f();g()},getParams:function(){return l},getCampuses:function(){return l.campuses},setTopics:function(m){l.topicIDs=m}}})();$(function(){central_calendarControls.init()})}());
